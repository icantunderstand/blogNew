---
title: 从Mixpanel看全埋点的技术实现
date: '2024-06-23'
tags: ['engineering']
---

笔者在工作中开发过通过babel编译阶段注入埋点代码的埋点方案.仔细想了下这样的方案并不优雅.在本身的业务逻辑中前置一段不可控的代码存在着一定的
风险.在之前的文章[如何设计一个前端监控上报工具](https://icantunderstand.github.io/blogNew/blog/frontEndTool/buildLogger)中梳理了
监控上报的相关实现.全埋点的实现跟监控上报的架构实现是相似的,在实现全埋点方案的时候需要思考:

- 明确埋点的类型和实现
- 组合不同类型的埋点
- 埋点业务类型上的技术设计(链路/对业务侵入性考量)
  下面就从这三个方面入手来分析Mixpanel的埋点实现.

## 自动埋点类型和实现

## 组合不同类型的埋点

## 埋点业务类型上的技术设计

## 埋点方案的一些思考

- 维护性
- 性能
  - 缓存队列(批量上报)
  - 设置采样率
- 如何设计链路埋点

## 参考/业界方案

[mixpanel-js](https://github.com/mixpanel/mixpanel-js)
