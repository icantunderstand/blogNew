3:I[9275,[],""]
5:I[1343,[],""]
6:I[8700,["231","static/chunks/231-c1dde1c428767cbe.js","379","static/chunks/379-27764ce8e5dccbef.js","185","static/chunks/app/layout-dcb4eac7ed9cbafe.js"],"ThemeProviders"]
7:I[4080,["231","static/chunks/231-c1dde1c428767cbe.js","379","static/chunks/379-27764ce8e5dccbef.js","185","static/chunks/app/layout-dcb4eac7ed9cbafe.js"],""]
8:I[9032,["231","static/chunks/231-c1dde1c428767cbe.js","379","static/chunks/379-27764ce8e5dccbef.js","185","static/chunks/app/layout-dcb4eac7ed9cbafe.js"],"KBarSearchProvider"]
9:I[231,["231","static/chunks/231-c1dde1c428767cbe.js","173","static/chunks/173-db634e5878be84f7.js","11","static/chunks/11-2354ace8f41a3e32.js","797","static/chunks/app/blog/%5B...slug%5D/page-e6d1b34369501aa1.js"],""]
a:I[509,["231","static/chunks/231-c1dde1c428767cbe.js","379","static/chunks/379-27764ce8e5dccbef.js","185","static/chunks/app/layout-dcb4eac7ed9cbafe.js"],"KBarButton"]
b:I[1398,["231","static/chunks/231-c1dde1c428767cbe.js","379","static/chunks/379-27764ce8e5dccbef.js","185","static/chunks/app/layout-dcb4eac7ed9cbafe.js"],"default"]
c:I[8976,["231","static/chunks/231-c1dde1c428767cbe.js","379","static/chunks/379-27764ce8e5dccbef.js","185","static/chunks/app/layout-dcb4eac7ed9cbafe.js"],"default"]
4:["slug","frontEndTool/sandbox","c"]
0:["QNgZ3skktWfG4qfpVd-9h",[[["",{"children":["blog",{"children":[["slug","frontEndTool/sandbox","c"],{"children":["__PAGE__?{\"slug\":[\"frontEndTool\",\"sandbox\"]}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":[["slug","frontEndTool/sandbox","c"],{"children":["__PAGE__",{},[["$L1","$L2"],null],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/85ae2e64502a42e4.css","precedence":"next","crossOrigin":"$undefined"}]]}],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},[["$","html",null,{"lang":"en-us","className":"__variable_587f35 scroll-smooth","suppressHydrationWarning":true,"children":[["$","link",null,{"rel":"apple-touch-icon","sizes":"76x76","href":"/static/favicons/apple-touch-icon.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"32x32","href":"/static/favicons/favicon-32x32.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"16x16","href":"/static/favicons/favicon-16x16.png"}],["$","link",null,{"rel":"manifest","href":"/static/favicons/site.webmanifest"}],["$","link",null,{"rel":"mask-icon","href":"/static/favicons/safari-pinned-tab.svg","color":"#5bbad5"}],["$","meta",null,{"name":"msapplication-TileColor","content":"#000000"}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: light)","content":"#fff"}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: dark)","content":"#000"}],["$","link",null,{"rel":"alternate","type":"application/rss+xml","href":"/feed.xml"}],["$","body",null,{"className":"bg-white pl-[calc(100vw-100%)] text-black antialiased dark:bg-gray-950 dark:text-white","children":["$","$L6",null,{"children":[["$undefined","$undefined","$undefined",["$","$L7",null,{"async":true,"defer":true,"data-website-id":"$undefined","src":"https://analytics.umami.is/script.js"}],"$undefined","$undefined"],["$","section",null,{"className":"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0","children":["$","div",null,{"className":"flex h-screen flex-col justify-between font-sans","children":[["$","$L8",null,{"kbarConfig":{"searchDocumentsPath":"search.json"},"children":[["$","header",null,{"className":"flex items-center justify-between py-10","children":[["$","div",null,{"children":["$","$L9",null,{"href":"/","aria-label":"noodles的笔记本","children":["$","div",null,{"className":"flex items-center justify-between","children":[["$","div",null,{"className":"mr-3","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","xmlnsXlink":"http://www.w3.org/1999/xlink","width":53.87,"height":43.61,"viewBox":"344.564 330.278 111.737 91.218","children":[["$","defs",null,{"children":[["$","linearGradient",null,{"id":"logo_svg__b","x1":420.97,"x2":420.97,"y1":331.28,"y2":418.5,"gradientUnits":"userSpaceOnUse","children":[["$","stop",null,{"offset":"0%","style":{"stopColor":"#06b6d4","stopOpacity":1}}],["$","stop",null,{"offset":"100%","style":{"stopColor":"#67e8f9","stopOpacity":1}}]]}],["$","linearGradient",null,{"id":"logo_svg__d","x1":377.89,"x2":377.89,"y1":331.28,"y2":418.5,"gradientUnits":"userSpaceOnUse","children":[["$","stop",null,{"offset":"0%","style":{"stopColor":"#06b6d4","stopOpacity":1}}],["$","stop",null,{"offset":"100%","style":{"stopColor":"#67e8f9","stopOpacity":1}}]]}],["$","path",null,{"id":"logo_svg__a","d":"M453.3 331.28v28.57l-64.66 58.65v-30.08z"}],["$","path",null,{"id":"logo_svg__c","d":"M410.23 331.28v28.57l-64.67 58.65v-30.08z"}]]}],["$","use",null,{"xlinkHref":"#logo_svg__a","fill":"url(#logo_svg__b)"}],["$","use",null,{"xlinkHref":"#logo_svg__c","fill":"url(#logo_svg__d)"}]]}]}],["$","div",null,{"className":"hidden h-6 text-2xl font-semibold sm:block","children":"noodles的笔记本"}]]}]}]}],["$","div",null,{"className":"flex items-center space-x-4 leading-5 sm:space-x-6","children":[[["$","$L9",null,{"href":"/blog","className":"hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"博客列表"}],["$","$L9",null,{"href":"/tags","className":"hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"标签"}],["$","$L9",null,{"href":"/projects","className":"hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"项目"}],["$","$L9",null,{"href":"/about","className":"hidden font-medium text-gray-900 dark:text-gray-100 sm:block","children":"了解"}]],["$","$La",null,{"aria-label":"Search","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","className":"h-6 w-6 text-gray-900 dark:text-gray-100","children":["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}]}]}],["$","$Lb",null,{}],["$","$Lc",null,{}]]}]]}],["$","main",null,{"className":"mb-auto","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"className":"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6","children":[["$","div",null,{"className":"space-x-2 pb-8 pt-6 md:space-y-5","children":["$","h1",null,{"className":"text-6xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 md:border-r-2 md:px-6 md:text-8xl md:leading-14","children":"404"}]}],["$","div",null,{"className":"max-w-md","children":[["$","p",null,{"className":"mb-4 text-xl font-bold leading-normal md:text-2xl","children":"Sorry we couldn't find this page."}],["$","p",null,{"className":"mb-8","children":"But dont worry, you can find plenty of other things on our homepage."}],["$","$L9",null,{"href":"/","className":"focus:shadow-outline-blue inline rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium leading-5 text-white shadow transition-colors duration-150 hover:bg-blue-700 focus:outline-none dark:hover:bg-blue-500","children":"Back to homepage"}]]}]]}],"notFoundStyles":[],"styles":null}]}]]}],["$","footer",null,{"children":["$","div",null,{"className":"mt-16 flex flex-col items-center","children":[["$","div",null,{"className":"mb-3 flex space-x-4","children":[["$","a",null,{"className":"text-sm text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"mailto:icantunderstand@yeah.net","children":[["$","span",null,{"className":"sr-only","children":"mail"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 20 20","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":[["$","title",null,{"children":"Mail"}],["$","path",null,{"d":"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}],["$","path",null,{"d":"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"}]]}]]}],["$","a",null,{"className":"text-sm text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://github.com/icantunderstand","children":[["$","span",null,{"className":"sr-only","children":"github"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 24 24","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":[["$","title",null,{"children":"Github"}],["$","path",null,{"d":"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"}]]}]]}],null,null,null,null,null,null,null]}],["$","div",null,{"className":"mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400","children":[["$","div",null,{"children":"noodles"}],["$","div",null,{"children":" • "}],["$","div",null,{"children":"© 2024"}],["$","div",null,{"children":" • "}],["$","$L9",null,{"href":"/","children":"noodles的笔记本"}]]}],["$","div",null,{"className":"mb-8 text-sm text-gray-500 dark:text-gray-400","children":["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://github.com/timlrx/tailwind-nextjs-starter-blog","children":"Tailwind Nextjs Theme"}]}]]}]}]]}]}]]}]}]]}],null],null],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/cd8041548bd261e3.css","precedence":"next","crossOrigin":"$undefined"}]],"$Ld"]]]]
e:I[1136,["231","static/chunks/231-c1dde1c428767cbe.js","173","static/chunks/173-db634e5878be84f7.js","11","static/chunks/11-2354ace8f41a3e32.js","797","static/chunks/app/blog/%5B...slug%5D/page-e6d1b34369501aa1.js"],"default"]
f:I[408,["231","static/chunks/231-c1dde1c428767cbe.js","173","static/chunks/173-db634e5878be84f7.js","11","static/chunks/11-2354ace8f41a3e32.js","797","static/chunks/app/blog/%5B...slug%5D/page-e6d1b34369501aa1.js"],"default"]
2:[["$","script",null,{"type":"application/ld+json","dangerouslySetInnerHTML":{"__html":"{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"前端沙盒的实现方式\",\"datePublished\":\"2022-01-18T00:00:00.000Z\",\"dateModified\":\"2022-01-18T00:00:00.000Z\",\"image\":\"\",\"url\":\"https://tailwind-nextjs-starter-blog.vercel.app/blog/frontEndTool/sandbox\",\"author\":[{\"@type\":\"Person\",\"name\":\"noodles\"}]}"}}],["$","$Le",null,{"content":{"title":"前端沙盒的实现方式","date":"2022-01-18T00:00:00.000Z","tags":["JavaScript"],"type":"Blog","readingTime":{"text":"7 min read","minutes":6.03,"time":361800,"words":1206},"slug":"frontEndTool/sandbox","path":"blog/frontEndTool/sandbox","filePath":"blog/frontEndTool/sandbox.mdx","toc":[{"value":"前置概念","url":"#前置概念-1","depth":2},{"value":"沙盒","url":"#沙盒-1","depth":3},{"value":"Proxy","url":"#proxy-1","depth":3},{"value":"with","url":"#with-1","depth":3},{"value":"沙盒的实现方式","url":"#沙盒的实现方式-1","depth":2},{"value":"ProxySandbox(单实例沙盒)","url":"#proxysandbox单实例沙盒-1","depth":3},{"value":"snapshotSandbox(单实例沙盒)","url":"#snapshotsandbox单实例沙盒-1","depth":3},{"value":"多实例沙盒","url":"#多实例沙盒-1","depth":3},{"value":"css隔离方案","url":"#css隔离方案-1","depth":2},{"value":"附录","url":"#附录-1","depth":2}],"structuredData":{"@context":"https://schema.org","@type":"BlogPosting","headline":"前端沙盒的实现方式","datePublished":"2022-01-18T00:00:00.000Z","dateModified":"2022-01-18T00:00:00.000Z","image":"","url":"https://tailwind-nextjs-starter-blog.vercel.app/blog/frontEndTool/sandbox","author":[{"@type":"Person","name":"noodles"}]}},"authorDetails":[{"name":"noodles","avatar":"/static/images/avatar.png","occupation":"工程师","company":"时间有限公司","email":"icantunderstand@yeah.net","github":"https://github.com/icantunderstand","type":"Authors","readingTime":{"text":"1 min read","minutes":0.4,"time":24000,"words":80},"slug":"default","path":"authors/default","filePath":"authors/default.mdx","toc":[]}],"next":{"title":"single-spa源码解读","date":"2022-01-19T00:00:00.000Z","tags":["JavaScript"],"type":"Blog","readingTime":{"text":"11 min read","minutes":10.56,"time":633600,"words":2112},"slug":"frontEndTool/singleSpa","path":"blog/frontEndTool/singleSpa","filePath":"blog/frontEndTool/singleSpa.mdx","toc":[{"value":"single-spa简单用法","url":"#single-spa简单用法-1","depth":2},{"value":"子应用配置","url":"#子应用配置-1","depth":3},{"value":"1.2. <a name='-1'></a>主应用配置","url":"#12-a-name-1a主应用配置-1","depth":3},{"value":"single-spa源码分析","url":"#single-spa源码分析-1","depth":2},{"value":"启动","url":"#启动-1","depth":3},{"value":"子应用挂载/切换","url":"#子应用挂载切换-1","depth":3},{"value":"关于微前端的一些总结思考","url":"#关于微前端的一些总结思考-1","depth":2}],"structuredData":{"@context":"https://schema.org","@type":"BlogPosting","headline":"single-spa源码解读","datePublished":"2022-01-19T00:00:00.000Z","dateModified":"2022-01-19T00:00:00.000Z","image":"","url":"https://tailwind-nextjs-starter-blog.vercel.app/blog/frontEndTool/singleSpa"}},"prev":{"title":"2022-1-1-前端快报","date":"2022-01-01T00:00:00.000Z","tags":["前端快报"],"type":"Blog","readingTime":{"text":"2 min read","minutes":1.82,"time":109200,"words":364},"slug":"weeklyReport/2022-1-1","path":"blog/weeklyReport/2022-1-1","filePath":"blog/weeklyReport/2022-1-1.mdx","toc":[{"value":"Tao of React - Software Design, Architecture & Best Practices","url":"#tao-of-react---software-design-architecture--best-practices-1","depth":3},{"value":"Implement Server-Sent Events in Node.js and React","url":"#implement-server-sent-events-in-nodejs-and-react-1","depth":3},{"value":"The only two custom React hooks we ever really use","url":"#the-only-two-custom-react-hooks-we-ever-really-use-1","depth":3},{"value":"useEffect sometimes fires before paint","url":"#useeffect-sometimes-fires-before-paint-1","depth":3},{"value":"Good advice on JSX conditionals","url":"#good-advice-on-jsx-conditionals-1","depth":3},{"value":"Sneak peek into React 18 useDeferredValue hook","url":"#sneak-peek-into-react-18-usedeferredvalue-hook-1","depth":3},{"value":"React: Event Bubbling and Capturing","url":"#react-event-bubbling-and-capturing-1","depth":3}],"structuredData":{"@context":"https://schema.org","@type":"BlogPosting","headline":"2022-1-1-前端快报","datePublished":"2022-01-01T00:00:00.000Z","dateModified":"2022-01-01T00:00:00.000Z","image":"","url":"https://tailwind-nextjs-starter-blog.vercel.app/blog/weeklyReport/2022-1-1"}},"children":[["$","p",null,{"children":"不同的微前端框架会提供沙盒环境来实现不同微前端应用的隔离.本文梳理JavaScript中沙盒的实现方式，有助于学习微前端方案的技术细节."}],["$","h2",null,{"className":"content-header","id":"前置概念","children":[["$","a",null,{"href":"#前置概念","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"前置概念"]}],["$","h3",null,{"className":"content-header","id":"沙盒","children":[["$","a",null,{"href":"#沙盒","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"沙盒"]}],["$","p",null,{"children":"沙盒是一种安全机制可以为程序提供隔离的执行环境，沙盒中提供用后即回收的磁盘及内存空间，在沙盒中对网络访问、对真实系统的访问、对输入设备的读取通常被禁止或是被严格限制的.JavaScript沙盒是通过语法层面的限制来实现代码执行的隔离."}],["$","h3",null,{"className":"content-header","id":"proxy","children":[["$","a",null,{"href":"#proxy","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Proxy"]}],["$","p",null,{"children":[["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy","children":"Proxy"}],"可以实现对对象属性访问的代理，通过Proxy的使用可以实现JavaScript代码执行的沙盒模式"]}],["$","h3",null,{"className":"content-header","id":"with","children":[["$","a",null,{"href":"#with","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"with"]}],["$","p",null,{"children":[["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/with","children":"with"}],"语句可以扩展当前的执行上下文"]}],["$","$Lf",null,{"className":"language-javascript","children":["$","code",null,{"className":"language-javascript code-highlight","children":[["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"const"}]," a ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"{"}]," ",["$","span",null,{"className":"token literal-property property","children":"name"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token number","children":"1111"}]," ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"with"}],["$","span",null,{"className":"token punctuation","children":"("}],"a",["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token class-name console","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],"name",["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token comment","children":"// 1111"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}]]}]}],["$","h2",null,{"className":"content-header","id":"沙盒的实现方式","children":[["$","a",null,{"href":"#沙盒的实现方式","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"沙盒的实现方式"]}],["$","p",null,{"children":"沙盒的实现方式上主要分为:"}],["$","ul",null,{"children":[["$","li",null,{"children":"单实例沙盒: 同一个时刻只有一个微应用实例存在，当前资源被这个应用独占，需要解决的主要问题是应用切换的时候变量污染清理和再次启动时的变量恢复"}],["$","li",null,{"children":"多实例沙盒: 资源不是应用独占，需要解决资源共享、通信等问题"}]]}],["$","h3",null,{"className":"content-header","id":"proxysandbox单实例沙盒","children":[["$","a",null,{"href":"#proxysandbox单实例沙盒","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"ProxySandbox(单实例沙盒)"]}],["$","p",null,{"children":"基于Proxy的拦截和设置功能，通过Proxy拦截对全局对象的修改记录，在应用切换的时候还原全局对象"}],["$","$Lf",null,{"className":"language-javascript","children":["$","code",null,{"className":"language-javascript code-highlight","children":[["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token comment doc-comment","children":"/** 设置全局对象属性 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token function function-variable","children":"setWindowProp"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token parameter","children":["prop",["$","span",null,{"className":"token punctuation","children":","}]," value"]}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token operator arrow","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"["}],"prop",["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"="}]," value\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token keyword","children":"class"}]," ",["$","span",null,{"className":"token class-name","children":"SandBox"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            name",["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token comment doc-comment","children":"/** 代理对象 需要通过该对象操作沙盒 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            proxy ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword nil null","children":"null"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token comment doc-comment","children":"/** 新增的修改 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            addedPropsMap ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token class-name","children":"Map"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token comment doc-comment","children":"/** 沙盒期间更新的修改 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            modifiedOriginValueProps ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token class-name","children":"Map"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token comment doc-comment","children":"/** 当前沙盒所做的修改 用于还原当前的沙盒 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            currentUpdatedProps ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token class-name","children":"Map"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token comment doc-comment","children":"/** 激活沙盒 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token function","children":"active"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"  \n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"currentUpdatedProps"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"forEach"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token parameter","children":["v",["$","span",null,{"className":"token punctuation","children":","}]," p"]}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token operator arrow","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    ",["$","span",null,{"className":"token function","children":"setWindowProp"}],["$","span",null,{"className":"token punctuation","children":"("}],"p",["$","span",null,{"className":"token punctuation","children":","}]," v",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token comment doc-comment","children":"/** 沙箱卸载 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token function","children":"inactive"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token comment doc-comment","children":"/** 修改的属性还原 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"modifiedOriginValueProps"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"forEach"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token parameter","children":["v",["$","span",null,{"className":"token punctuation","children":","}]," p"]}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token operator arrow","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    ",["$","span",null,{"className":"token function","children":"setWindowProp"}],["$","span",null,{"className":"token punctuation","children":"("}],"p",["$","span",null,{"className":"token punctuation","children":","}]," v",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token comment doc-comment","children":"/** 增加的属性清空 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"addedPropsMap"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"forEach"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token parameter","children":["_",["$","span",null,{"className":"token punctuation","children":","}]," p"]}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token operator arrow","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    ",["$","span",null,{"className":"token function","children":"setWindowProp"}],["$","span",null,{"className":"token punctuation","children":"("}],"p",["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token keyword nil","children":"undefined"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token function","children":"constructor"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token parameter","children":"name"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"name"}]," ",["$","span",null,{"className":"token operator","children":"="}]," name",["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword","children":"const"}]," fakeWindow ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token class-name known-class-name","children":"Object"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"create"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token keyword nil null","children":"null"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword","children":"const"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    addedPropsMap",["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    modifiedOriginValueProps",["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    currentUpdatedProps",["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token punctuation","children":"}"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"this"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword","children":"const"}]," proxy ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token class-name","children":"Proxy"}],["$","span",null,{"className":"token punctuation","children":"("}],"fakeWindow",["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    ",["$","span",null,{"className":"token function","children":"get"}],["$","span",null,{"className":"token punctuation","children":"("}],"target",["$","span",null,{"className":"token punctuation","children":","}]," prop",["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                        ",["$","span",null,{"className":"token keyword control-flow","children":"return"}]," ",["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"["}],"prop",["$","span",null,{"className":"token punctuation","children":"]"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    ",["$","span",null,{"className":"token function","children":"set"}],["$","span",null,{"className":"token punctuation","children":"("}],"_",["$","span",null,{"className":"token punctuation","children":","}]," prop",["$","span",null,{"className":"token punctuation","children":","}]," value",["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                        ",["$","span",null,{"className":"token keyword control-flow","children":"if"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token operator","children":"!"}],["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"hasOwnProperty"}],["$","span",null,{"className":"token punctuation","children":"("}],"prop",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                            ",["$","span",null,{"className":"token comment doc-comment","children":"/** window上没有该属性 新增 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                            addedPropsMap",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"set"}],["$","span",null,{"className":"token punctuation","children":"("}],"prop",["$","span",null,{"className":"token punctuation","children":","}]," value",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                        ",["$","span",null,{"className":"token punctuation","children":"}"}]," ",["$","span",null,{"className":"token keyword control-flow","children":"else"}]," ",["$","span",null,{"className":"token keyword control-flow","children":"if"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token operator","children":"!"}],"modifiedOriginValueProps",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"hasOwnProperty"}],["$","span",null,{"className":"token punctuation","children":"("}],"prop",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                            ",["$","span",null,{"className":"token comment doc-comment","children":"/** window上有该属性且未更新,记录 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                            ",["$","span",null,{"className":"token keyword","children":"const"}]," originValue ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"["}],"prop",["$","span",null,{"className":"token punctuation","children":"]"}]," \n"]}],["$","span",null,{"className":"code-line","children":["                            ",["$","span",null,{"className":"token function","children":"modifiedOriginValueProps"}],["$","span",null,{"className":"token punctuation","children":"("}],"prop",["$","span",null,{"className":"token punctuation","children":","}]," originValue",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                        ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                        ",["$","span",null,{"className":"token comment doc-comment","children":"/** 记录当前沙盒的更新 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                        currentUpdatedProps",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"set"}],["$","span",null,{"className":"token punctuation","children":"("}],"prop",["$","span",null,{"className":"token punctuation","children":","}]," value",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                        ",["$","span",null,{"className":"token comment doc-comment","children":"/** 更新全局属性 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                        ",["$","span",null,{"className":"token function","children":"setWindowProp"}],["$","span",null,{"className":"token punctuation","children":"("}],"prop",["$","span",null,{"className":"token punctuation","children":","}]," value",["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                        ",["$","span",null,{"className":"token keyword control-flow","children":"return"}]," ",["$","span",null,{"className":"token boolean","children":"true"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"proxy"}]," ",["$","span",null,{"className":"token operator","children":"="}]," proxy\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token keyword","children":"const"}]," newSandBox ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token class-name","children":"SandBox"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"'app'"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token keyword","children":"const"}]," proxyWindow ",["$","span",null,{"className":"token operator","children":"="}]," newSandBox",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"proxy"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        proxyWindow",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token string","children":"'app'"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token class-name console","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}],["$","span",null,{"className":"token punctuation","children":","}]," proxyWindow",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token comment","children":"// app app"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        newSandBox",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"inactive"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token class-name console","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}],["$","span",null,{"className":"token punctuation","children":","}]," proxyWindow",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token comment","children":"// undefined undefined"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        newSandBox",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"active"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token class-name console","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}],["$","span",null,{"className":"token punctuation","children":","}]," proxyWindow",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token comment","children":"// app app"}],"\n"]}]]}]}],["$","h3",null,{"className":"content-header","id":"snapshotsandbox单实例沙盒","children":[["$","a",null,{"href":"#snapshotsandbox单实例沙盒","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"snapshotSandbox(单实例沙盒)"]}],["$","p",null,{"children":"快照沙盒是在不支持Proxy的环境下，通过将window对象属性都复制到快照对象上然后再激活和卸载的时候对激活期间的diff进行添加或者回退.这个方案的对比方案较复杂，比如考虑到原型链的修改与还原问题，一般不作为沙盒方案的首选."}],["$","$Lf",null,{"className":"language-javascript","children":["$","code",null,{"className":"language-javascript code-highlight","children":[["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"class"}]," ",["$","span",null,{"className":"token class-name","children":"SnapshotSandbox"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token function","children":"constructor"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token parameter","children":"name"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"name"}]," ",["$","span",null,{"className":"token operator","children":"="}]," name",["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"proxy"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"type"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token string","children":"'Snapshot'"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"sandboxRunning"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token boolean","children":"true"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"windowSnapshot"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"modifyPropsMap"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"active"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token comment","children":"//激活"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token function","children":"active"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token comment","children":"// 记录当前快照"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"windowSnapshot"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token function","children":"iter"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token parameter","children":"prop"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token operator arrow","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"windowSnapshot"}],["$","span",null,{"className":"token punctuation","children":"["}],"prop",["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"["}],"prop",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token comment","children":"// 恢复之前的变更"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token class-name known-class-name","children":"Object"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"keys"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"modifyPropsMap"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"forEach"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token parameter","children":"p"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token operator arrow","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"["}],"p",["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"modifyPropsMap"}],["$","span",null,{"className":"token punctuation","children":"["}],"p",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"sandboxRunning"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token boolean","children":"true"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token comment","children":"//还原"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token function","children":"inactive"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token function","children":"iter"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token parameter","children":"prop"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token operator arrow","children":"=>"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword control-flow","children":"if"}]," ",["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"["}],"prop",["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"!=="}]," ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"windowSnapshot"}],["$","span",null,{"className":"token punctuation","children":"["}],"prop",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    ",["$","span",null,{"className":"token comment","children":"// 记录变更，恢复环境"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"modifyPropsMap"}],["$","span",null,{"className":"token punctuation","children":"["}],"prop",["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"["}],"prop",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":"                \n"}],["$","span",null,{"className":"code-line","children":["                    ",["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"["}],"prop",["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"windowSnapshot"}],["$","span",null,{"className":"token punctuation","children":"["}],"prop",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"sandboxRunning"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token boolean","children":"false"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":"   \n"}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"const"}]," sandbox ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token class-name","children":"SnapshotSandbox"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"const"}]," proxyWindow ",["$","span",null,{"className":"token operator","children":"="}]," sandbox",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"proxy"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    sandbox",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"active"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    proxyWindow",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token string","children":"'app'"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token class-name console","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],"proxyWindow",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token comment","children":"// app app"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    sandbox",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"inactive"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token class-name console","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],"proxyWindow",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token comment","children":"// undefined undefined"}],"\n"]}]]}]}],["$","h3",null,{"className":"content-header","id":"多实例沙盒","children":[["$","a",null,{"href":"#多实例沙盒","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"多实例沙盒"]}],["$","p",null,{"children":"多实例沙盒是Proxy实现的单实例的变种版，在Proxy实现的单实例沙盒中，Proxy的handler的get/set是直接操作的全局对象,多实例版本在handler的get/set中操作沙盒自己维护的对象，从而实现多实例模式"}],["$","$Lf",null,{"className":"language-javascript","children":["$","code",null,{"className":"language-javascript code-highlight","children":[["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"class"}]," ",["$","span",null,{"className":"token class-name","children":"MultiProxySandbox"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        name",["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        proxy ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword nil null","children":"null"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token comment doc-comment","children":"/** context 传入多实例沙盒共享数据 */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token function","children":"constructor"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token parameter","children":["name",["$","span",null,{"className":"token punctuation","children":","}]," context",["$","span",null,{"className":"token operator","children":"="}],["$","span",null,{"className":"token punctuation","children":"{"}],["$","span",null,{"className":"token punctuation","children":"}"}]]}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"name"}]," ",["$","span",null,{"className":"token operator","children":"="}]," name",["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"const"}]," fakeWindow ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token class-name known-class-name","children":"Object"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"create"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token punctuation","children":"{"}],["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"const"}]," proxy ",["$","span",null,{"className":"token operator","children":"="}],"  ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token class-name","children":"Proxy"}],["$","span",null,{"className":"token punctuation","children":"("}],"fakeWindow",["$","span",null,{"className":"token punctuation","children":","}],["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token function","children":"set"}],["$","span",null,{"className":"token punctuation","children":"("}],"target",["$","span",null,{"className":"token punctuation","children":","}]," name",["$","span",null,{"className":"token punctuation","children":","}]," value",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token comment doc-comment","children":"/** 返回共享属性  */"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword control-flow","children":"if"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token class-name known-class-name","children":"Object"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"keys"}],["$","span",null,{"className":"token punctuation","children":"("}],"context",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"includes"}],["$","span",null,{"className":"token punctuation","children":"("}],"name",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    context",["$","span",null,{"className":"token punctuation","children":"["}],"name",["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"="}]," value",["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                target",["$","span",null,{"className":"token punctuation","children":"["}],"name",["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"="}]," value",["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":","}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token function","children":"get"}],["$","span",null,{"className":"token punctuation","children":"("}],"target",["$","span",null,{"className":"token punctuation","children":","}],"name",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token comment","children":"// 优先使用共享对象"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword control-flow","children":"if"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token class-name known-class-name","children":"Object"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"keys"}],["$","span",null,{"className":"token punctuation","children":"("}],"context",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"includes"}],["$","span",null,{"className":"token punctuation","children":"("}],"name",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                    ",["$","span",null,{"className":"token keyword control-flow","children":"return"}]," context",["$","span",null,{"className":"token punctuation","children":"["}],"name",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword control-flow","children":"if"}],["$","span",null,{"className":"token punctuation","children":"("}]," ",["$","span",null,{"className":"token keyword","children":"typeof"}]," target",["$","span",null,{"className":"token punctuation","children":"["}]," name ",["$","span",null,{"className":"token punctuation","children":"]"}]," ",["$","span",null,{"className":"token operator","children":"==="}]," ",["$","span",null,{"className":"token string","children":"'function'"}]," ",["$","span",null,{"className":"token operator","children":"&&"}]," ",["$","span",null,{"className":"token regex","children":[["$","span",null,{"className":"token regex-delimiter","children":"/"}],["$","span",null,{"className":"token language-regex regex-source","children":[["$","span",null,{"className":"token function anchor","children":"^"}],["$","span",null,{"className":"token char-class","children":[["$","span",null,{"className":"token punctuation char-class-punctuation","children":"["}],["$","span",null,{"className":"token range","children":["a",["$","span",null,{"className":"token operator range-punctuation","children":"-"}],"z"]}],["$","span",null,{"className":"token punctuation char-class-punctuation","children":"]"}]]}]]}],["$","span",null,{"className":"token regex-delimiter","children":"/"}]]}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"test"}],["$","span",null,{"className":"token punctuation","children":"("}],"name",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword control-flow","children":"return"}]," target",["$","span",null,{"className":"token punctuation","children":"["}]," name ",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"bind"}]," ",["$","span",null,{"className":"token operator","children":"&&"}]," target",["$","span",null,{"className":"token punctuation","children":"["}]," name ",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"bind"}],["$","span",null,{"className":"token punctuation","children":"("}]," target ",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token punctuation","children":"}"}]," ",["$","span",null,{"className":"token keyword control-flow","children":"else"}]," ",["$","span",null,{"className":"token punctuation","children":"{"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token keyword control-flow","children":"return"}]," target",["$","span",null,{"className":"token punctuation","children":"["}]," name ",["$","span",null,{"className":"token punctuation","children":"]"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["                ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword","children":"this"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"proxy"}]," ",["$","span",null,{"className":"token operator","children":"="}]," proxy\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token keyword control-flow","children":"return"}]," proxy\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token punctuation","children":"}"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"const"}]," context ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token punctuation","children":"{"}]," ",["$","span",null,{"className":"token literal-property property","children":"document"}],["$","span",null,{"className":"token operator","children":":"}]," ",["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"document"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token literal-property property","children":"globalData"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token string","children":"'abc'"}],["$","span",null,{"className":"token punctuation","children":"}"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"const"}]," newSandBox1 ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token class-name","children":"MultiProxySandbox"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"'app1'"}],["$","span",null,{"className":"token punctuation","children":","}],"context",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token keyword","children":"const"}]," newSandBox2 ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token keyword","children":"new"}]," ",["$","span",null,{"className":"token class-name","children":"MultiProxySandbox"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"'app2'"}],["$","span",null,{"className":"token punctuation","children":","}],"context",["$","span",null,{"className":"token punctuation","children":")"}],["$","span",null,{"className":"token punctuation","children":";"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    newSandBox1",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token string","children":"'app1'"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    newSandBox2",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}]," ",["$","span",null,{"className":"token operator","children":"="}]," ",["$","span",null,{"className":"token string","children":"'app2'"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token class-name console","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],"newSandBox1",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}],["$","span",null,{"className":"token punctuation","children":","}]," newSandBox2",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}],["$","span",null,{"className":"token punctuation","children":","}]," ",["$","span",null,{"className":"token dom variable","children":"window"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"appName"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token comment","children":"// app1 app2 undefined"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token class-name console","children":"console"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access function method","children":"log"}],["$","span",null,{"className":"token punctuation","children":"("}],"newSandBox1",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"globalData"}],["$","span",null,{"className":"token punctuation","children":","}]," newSandBox2",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"globalData"}],["$","span",null,{"className":"token punctuation","children":")"}]," ",["$","span",null,{"className":"token comment","children":"// abc abc"}],"\n"]}]]}]}],["$","h2",null,{"className":"content-header","id":"css隔离方案","children":[["$","a",null,{"href":"#css隔离方案","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"css隔离方案"]}],["$","ul",null,{"children":[["$","li",null,{"children":"css模块化 将CSS的作用域隔离"}],["$","li",null,{"children":"css-in-js 样式代码直接内嵌到JavaScript代码中"}],["$","li",null,{"children":"Shadow Dom 实现样式隔离"}]]}],["$","h2",null,{"className":"content-header","id":"附录","children":[["$","a",null,{"href":"#附录","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"附录"]}],["$","p",null,{"children":[["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://juejin.cn/post/6844904066225537037","children":"字节跳动的微前端沙盒实践"}],["$","br",null,{}],["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://mp.weixin.qq.com/s/iLdAH9p2-S8pFyZrNzYaNg","children":"前端微服务在字节跳动的打磨与应用"}],["$","br",null,{}],["$","a",null,{"target":"_blank","rel":"noopener noreferrer","href":"https://cloud.tencent.com/developer/article/1748172","children":"谈谈微前端领域的js沙箱实现机制"}]]}]]}]]
d:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"前端沙盒的实现方式 | noodles的笔记本"}],["$","meta","3",{"name":"robots","content":"index, follow"}],["$","meta","4",{"name":"googlebot","content":"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"}],["$","link","5",{"rel":"canonical","href":"https://tailwind-nextjs-starter-blog.vercel.app/blog/frontEndTool/sandbox"}],["$","link","6",{"rel":"alternate","type":"application/rss+xml","href":"https://tailwind-nextjs-starter-blog.vercel.app/feed.xml"}],["$","meta","7",{"property":"og:title","content":"前端沙盒的实现方式"}],["$","meta","8",{"property":"og:url","content":"https://tailwind-nextjs-starter-blog.vercel.app/blog/frontEndTool/sandbox"}],["$","meta","9",{"property":"og:site_name","content":"noodles的笔记本"}],["$","meta","10",{"property":"og:locale","content":"en_US"}],["$","meta","11",{"property":"og:image","content":"https://tailwind-nextjs-starter-blog.vercel.app/"}],["$","meta","12",{"property":"og:type","content":"article"}],["$","meta","13",{"property":"article:published_time","content":"2022-01-18T00:00:00.000Z"}],["$","meta","14",{"property":"article:modified_time","content":"2022-01-18T00:00:00.000Z"}],["$","meta","15",{"property":"article:author","content":"noodles"}],["$","meta","16",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","17",{"name":"twitter:title","content":"前端沙盒的实现方式"}],["$","meta","18",{"name":"next-size-adjust"}]]
1:null
